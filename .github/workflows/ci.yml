name: CI

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  validate:
    name: Validar CÃ³digo
    runs-on: ubuntu-latest

    steps:
      - name: Checkout cÃ³digo
        uses: actions/checkout@v4

      - name: Mostrar informaciÃ³n del repositorio
        run: |
          echo "ğŸ“ Repositorio: ${{ github.repository }}"
          echo "ğŸŒ¿ Rama: ${{ github.ref_name }}"
          echo "ğŸ‘¤ Actor: ${{ github.actor }}"
          echo "ğŸ“ Commit: ${{ github.sha }}"

      - name: Listar archivos del proyecto
        run: |
          echo "ğŸ“‚ Estructura del proyecto:"
          ls -la
          echo ""
          echo "ğŸ“‚ Contenido de src/:"
          ls -la src/

      - name: Verificar sintaxis JavaScript
        run: |
          echo "ğŸ” Verificando sintaxis de archivos JS..."
          for file in src/*.js; do
            echo "  Verificando: $file"
            node --check "$file"
          done
          echo "âœ… Sintaxis correcta"

      - name: Ejecutar tests
        run: |
          echo "ğŸ§ª Ejecutando tests..."
          npm test

      - name: Verificar que no hay TODOs
        run: |
          echo "ğŸ” Buscando TODO/FIXME en el cÃ³digo..."
          if grep -r "TODO\|FIXME" src/; then
            echo "âš ï¸ Advertencia: Se encontraron TODO/FIXME"
          else
            echo "âœ… No se encontraron TODO/FIXME"
          fi

      - name: Resumen final
        run: |
          echo ""
          echo "=========================================="
          echo "âœ… Pipeline completado exitosamente"
          echo "=========================================="
